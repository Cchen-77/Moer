\hypertarget{_frame_8h_source}{}\doxysection{Frame.\+h}
\label{_frame_8h_source}\index{Frame.h@{Frame.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//}}
\DoxyCodeLine{2 \textcolor{comment}{// Created by yjp on 2022/6/6.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include "{}Geometry.h"{}}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}CoreLayer/Math/Common.h"{}}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{static} \textcolor{keywordtype}{void} coordinateSystem(\textcolor{keyword}{const} \mbox{\hyperlink{struct_normal3d}{Normal3d}} \&a, \mbox{\hyperlink{struct_t_vector3}{Vec3d}}  \&b, \mbox{\hyperlink{struct_t_vector3}{Vec3d}}  \&c) \{}
\DoxyCodeLine{23     \textcolor{keywordflow}{if} (std::abs(a.x) > std::abs(a.y)) \{}
\DoxyCodeLine{24         \textcolor{keywordtype}{float} invLen = 1.0f / std::sqrt(a.x * a.x + a.z * a.z);}
\DoxyCodeLine{25         c = \mbox{\hyperlink{struct_t_vector3}{Vec3d}} (a.z * invLen, 0.0f, -\/a.x * invLen);}
\DoxyCodeLine{26     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{27         \textcolor{keywordtype}{float} invLen = 1.0f / std::sqrt(a.y * a.y + a.z * a.z);}
\DoxyCodeLine{28         c = \mbox{\hyperlink{struct_t_vector3}{Vec3d}}(0.0f, a.z * invLen, -\/a.y * invLen);}
\DoxyCodeLine{29     \}}
\DoxyCodeLine{30     \mbox{\hyperlink{struct_t_vector3}{Vec3d}}  \_a(a.x,a.y,a.z);}
\DoxyCodeLine{31     b = cross(\_a,c);}
\DoxyCodeLine{32 \}}
\DoxyCodeLine{33 }
\DoxyCodeLine{36 \textcolor{keyword}{struct }\mbox{\hyperlink{struct_frame}{Frame}} \{}
\DoxyCodeLine{37     \mbox{\hyperlink{struct_t_vector3}{Vec3d}} s, t;}
\DoxyCodeLine{38     \mbox{\hyperlink{struct_normal3d}{Normal3d}}  n;}
\DoxyCodeLine{39 }
\DoxyCodeLine{41     \mbox{\hyperlink{struct_frame_ad2e5946cf41d4817e750500acf05d02b}{Frame}}() \{ \}}
\DoxyCodeLine{42 }
\DoxyCodeLine{44     \mbox{\hyperlink{struct_frame_a7749295b5d75079e15d19946acb5254a}{Frame}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}}  \&s, \textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&t, \textcolor{keyword}{const} \mbox{\hyperlink{struct_normal3d}{Normal3d}}  \&n)}
\DoxyCodeLine{45             : s(s), t(t), n(n) \{ \}}
\DoxyCodeLine{46 }
\DoxyCodeLine{48     \mbox{\hyperlink{struct_frame_a3812db625a40925378672674ea5992a3}{Frame}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&x, \textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&y, \textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&z)}
\DoxyCodeLine{49             : s(x), t(y), n(z.x,z.y,z.z) \{ \}}
\DoxyCodeLine{50 }
\DoxyCodeLine{52     \mbox{\hyperlink{struct_frame_a05825e3ae8908e5bdb89ee6631e2e7ca}{Frame}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_normal3d}{Normal3d}} n) : n(n)\{}
\DoxyCodeLine{53         coordinateSystem(n, s, t);}
\DoxyCodeLine{54     \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{57     \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \mbox{\hyperlink{struct_frame_afe55aa248e8cf1792d80f985352166d9}{toLocal}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{58         \textcolor{keywordflow}{return} \mbox{\hyperlink{struct_t_vector3}{Vec3d}}(}
\DoxyCodeLine{59                 dot(v,s), dot(v,t), dot(v,n)}
\DoxyCodeLine{60         );}
\DoxyCodeLine{61     \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{64     \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \mbox{\hyperlink{struct_frame_a079d02ee6fa1c9dfbc09b9d53d3fee78}{toWorld}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{65         \textcolor{keywordflow}{return} s * v.x + t * v.y   + n * v.z ;}
\DoxyCodeLine{66     \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{70     \textcolor{keyword}{static} \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_acc3afa4f7865320db0a81a946cd73497}{cosTheta}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v) \{}
\DoxyCodeLine{71         \textcolor{keywordflow}{return} v.z;}
\DoxyCodeLine{72     \}}
\DoxyCodeLine{73 }
\DoxyCodeLine{76     \textcolor{keyword}{static} \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{sinTheta}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v) \{}
\DoxyCodeLine{77         \textcolor{keywordtype}{float} temp = \mbox{\hyperlink{struct_frame_ad83e0e53746cceb5fe30a5edb4e1b490}{sinTheta2}}(v);}
\DoxyCodeLine{78         \textcolor{keywordflow}{if} (temp <= 0.0f)}
\DoxyCodeLine{79             \textcolor{keywordflow}{return} 0.0f;}
\DoxyCodeLine{80         \textcolor{keywordflow}{return} std::sqrt(temp);}
\DoxyCodeLine{81     \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{85     \textcolor{keyword}{static} \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_a6de539bfd929d602c3a57ee049e6331e}{tanTheta}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v) \{}
\DoxyCodeLine{86         \textcolor{keywordtype}{float} temp = 1 -\/ v.z*v.z;}
\DoxyCodeLine{87         \textcolor{keywordflow}{if} (temp <= 0.0f)}
\DoxyCodeLine{88             \textcolor{keywordflow}{return} 0.0f;}
\DoxyCodeLine{89         \textcolor{keywordflow}{return} std::sqrt(temp) / v.z;}
\DoxyCodeLine{90     \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{94     \textcolor{keyword}{static} \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_ad83e0e53746cceb5fe30a5edb4e1b490}{sinTheta2}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v) \{}
\DoxyCodeLine{95         \textcolor{keywordflow}{return} 1.0f -\/ v.z * v.z;}
\DoxyCodeLine{96     \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{100     \textcolor{keyword}{static} \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_a1340ec99788fefde702f043a4ffc93c3}{sinPhi}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v) \{}
\DoxyCodeLine{101         \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{sinTheta}} = \mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{Frame::sinTheta}}(v);}
\DoxyCodeLine{102         \textcolor{keywordflow}{if} (\mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{sinTheta}} == 0.0f)}
\DoxyCodeLine{103             \textcolor{keywordflow}{return} 1.0f;}
\DoxyCodeLine{104         \textcolor{keywordflow}{return} clamp(v.y / \mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{sinTheta}}, -\/1.0f, 1.0f);}
\DoxyCodeLine{105     \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{109     \textcolor{keyword}{static} \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_a9516d7ef17c182b1192c179c861906b7}{cosPhi}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v) \{}
\DoxyCodeLine{110         \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{sinTheta}} = \mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{Frame::sinTheta}}(v);}
\DoxyCodeLine{111         \textcolor{keywordflow}{if} (\mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{sinTheta}} == 0.0f)}
\DoxyCodeLine{112             \textcolor{keywordflow}{return} 1.0f;}
\DoxyCodeLine{113         \textcolor{keywordflow}{return} clamp(v.x / \mbox{\hyperlink{struct_frame_a57073384606ae0b0f53a5c636c95cd08}{sinTheta}}, -\/1.0f, 1.0f);}
\DoxyCodeLine{114     \}}
\DoxyCodeLine{115 }
\DoxyCodeLine{119     \textcolor{keyword}{static} \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_ac5a798094759b36a5650699b8d1bcad9}{sinPhi2}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v) \{}
\DoxyCodeLine{120         \textcolor{keywordflow}{return} clamp(v.y * v.y / \mbox{\hyperlink{struct_frame_ad83e0e53746cceb5fe30a5edb4e1b490}{sinTheta2}}(v), 0.0f, 1.0f);}
\DoxyCodeLine{121     \}}
\DoxyCodeLine{122 }
\DoxyCodeLine{126     \textcolor{keyword}{static} \textcolor{keywordtype}{float} \mbox{\hyperlink{struct_frame_a60f5fc5850e7ca23f211053ace0b7b17}{cosPhi2}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_t_vector3}{Vec3d}} \&v) \{}
\DoxyCodeLine{127         \textcolor{keywordflow}{return} clamp(v.x * v.x / \mbox{\hyperlink{struct_frame_ad83e0e53746cceb5fe30a5edb4e1b490}{sinTheta2}}(v), 0.0f, 1.0f);}
\DoxyCodeLine{128     \}}
\DoxyCodeLine{129 }
\DoxyCodeLine{131     \textcolor{keywordtype}{bool} \mbox{\hyperlink{struct_frame_ac8147d1881c28bd0a96cc9ad5a0f361d}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_frame}{Frame}} \&frame)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{132         \textcolor{keywordflow}{return} frame.s == s \&\& frame.t == t \&\& frame.n == n;}
\DoxyCodeLine{133     \}}
\DoxyCodeLine{134 }
\DoxyCodeLine{136     \textcolor{keywordtype}{bool} \mbox{\hyperlink{struct_frame_aefc1e8a4b90f06c0b45f7fcea3ec9c01}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_frame}{Frame}} \&frame)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{137         \textcolor{keywordflow}{return} !\mbox{\hyperlink{struct_frame_ac8147d1881c28bd0a96cc9ad5a0f361d}{operator==}}(frame);}
\DoxyCodeLine{138     \}}
\DoxyCodeLine{139 }
\DoxyCodeLine{140 }
\DoxyCodeLine{141 \};}

\end{DoxyCode}
