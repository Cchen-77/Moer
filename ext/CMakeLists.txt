set(3DPARTY_FOLDER ext)
## compile for catch2
# add_subdirectory(catch2)

if (NOT TARGET assimp)
    set(ASSIMP_FOLDER ${3DPARTY_FOLDER}/assimp)
    set(ASSIMP_BUILD_OBJ_IMPORTER ON)
    set(ASSIMP_DOUBLE_PRECISION ON)
    set(ASSIMP_WARNINGS_AS_ERRORS OFF)
    set(ASSIMP_BUILD_ASSIMP_TOOLS OFF)
    set(ASSIMP_BUILD_TESTS OFF)
    set(ASSIMP_INSTALL OFF)
    add_subdirectory(assimp)
    set_target_properties(assimp PROPERTIES DEBUG_POSTFIX "_d")
    set_target_properties(assimp PROPERTIES RELEASE_POSTFIX "_r")

    # target_include_directories(assimp PUBLIC $<BUILD_INTERFACE:${PROJECT_3RDPARTY_PATH}/assimp/include>)
    set_target_properties(assimp PROPERTIES FOLDER ${ASSIMP_FOLDER})
    set_target_properties(UpdateAssimpLibsDebugSymbolsAndDLLs PROPERTIES FOLDER ${ASSIMP_FOLDER})

    if (TARGET zlibstatic)
        set_target_properties(zlibstatic PROPERTIES FOLDER ${ASSIMP_FOLDER})
    endif()
endif()

if (NOT TARGET embree)
    set(EMBREE_FOLDER ${3DPARTY_FOLDER}/embree)
    if(EMBREE_USE_TBB)
        set(EMBREE_TASKING_SYSTEM TBB)
    else()
        if(WIN32)
            set(EMBREE_TASKING_SYSTEM PPL)
        else()
            set(EMBREE_TASKING_SYSTEM INTERNAL)
        endif()
    endif()

    add_subdirectory(embree3)
    set_target_properties(embree PROPERTIES DEBUG_POSTFIX "_d")
    set_target_properties(embree PROPERTIES RELEASE_POSTFIX "_r")

    set_target_properties(embree PROPERTIES FOLDER ${EMBREE_FOLDER})
    set_target_properties(lexers PROPERTIES FOLDER ${EMBREE_FOLDER}/common)
    set_target_properties(math PROPERTIES FOLDER ${EMBREE_FOLDER}/common)
    set_target_properties(simd PROPERTIES FOLDER ${EMBREE_FOLDER}/common)
    set_target_properties(sys PROPERTIES FOLDER ${EMBREE_FOLDER}/common)
    set_target_properties(tasking PROPERTIES FOLDER ${EMBREE_FOLDER}/common)
    set_target_properties(embree_avx PROPERTIES FOLDER ${EMBREE_FOLDER}/kernels)
    set_target_properties(embree_avx2 PROPERTIES FOLDER ${EMBREE_FOLDER}/kernels)
    set_target_properties(embree_sse42 PROPERTIES FOLDER ${EMBREE_FOLDER}/kernels)
endif()
